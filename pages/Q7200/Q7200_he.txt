בקריפטוגרפיה, ARIA הוא צופן בלוקים סימטרי שפותח ב-2004 על ידי קבוצת חוקרים ב-NSRI עבור המשרד לתקנים וטכנולוגיה של דרום קוריאה (KATS), החבר בגופי התקינה הבינלאומיים ISO ו-IEC.
האלגוריתם בנוי מרשת החלפה-תמורה אינוולוציונית ולמעשה המפרט והממשק שלו דומים במידה רבה ל-AES. הוא מקבל בלוק טקסט קריא באורך 128 סיביות ומפתח הצפנה בשלושה אורכים אפשריים: 128, 192 או 256 סיביות ומפיק מהטקסט הקריא בלוק מוצפן באורך 128 סיביות. הוא עושה שימוש בתיבות החלפה (Sbox) בגודל 
  
    
      
        8
        ×
        8
      
    
    {\displaystyle 8\times 8}
  
 סיביות המבוססות על תיבות ההחלפה של ריינדל והוא פועל ב-12, 14, או 16 סבבים בהתאם לאורך המפתח. תהליך הכנת מפתח ההצפנה מרחיב את המפתח המסופק על ידי המשתמש באמצעות רשת פייסטל משולשת בתוספת קבועים שהם הייצוג הבינארי של 
  
    
      
        
          π
          
            −
            1
          
        
      
    
    {\displaystyle \pi ^{-1}}
  
 (זאת במטרה להוכיח שאינו מכיל דלתות סתר).
האלגוריתם הפך לתקן רשמי של KATS וכן IETF, הוצע בטיוטה RFC 5794 וכן הוצע כתוסף לפרוטוקול SSL/TLS בטיוטה RFC 6209. ביטחונו נחקר היטב על ידי מומחי הצפנה, ביניהם ניתן למנות כמה מחקרים שמראים שהצופן בטוח לשימוש בגרסה העדכנית שלו ולא נמצאו בו פגמים רציניים.


== גרסאות והיבטי יישום ==

ARIA 0.8 הוצע לראשונה ב-2003 בוועידה השנתית לאבטחת מידע של דרום קוריאה. בתחילה הצופן הכיל רק 10, 12, או 14 סבבים בהתאם לאורך המפתח 128/192/256 והכיל רק שתי תיבות החלפה בהן נעשה שימוש לסירוגין. בגרסה 0.9 שהוצעה ב-ICIS 2003 נוספו שתי תיבות החלפה. גרסה 1.0 הנוכחית הוכרזה והופצה על ידי NSRI ב-2004. מספר הסבבים עלה ל-12/14/16 בהתאמה וכן בוצעו שינויים בתהליך הרחבת המפתח. בדצמבר 2004 הכניס מכון התקנים של דרום קוריאה את הצופן לתקן KS X 1213.
ARIA מתאים ליישום בחומרת 8 ביט וכן ב-32 ביט הן בתוכנה והן בחומרה. רוב הפעולות בצופן הן פעולות החלפה פשוטות אותן אפשר לבצע ביעילות עם טבלאות חיפוש (lookup table). אם הזיכרון זמין ניתן להמיר את שכבת הפיזור להכפלה בארבע מטריצות וכן אפשר לשלב את שכבת ההחלפה יחד עם שכבת הפיזור באופן יעיל ולהשיג בכך שיפור משמעותי בתפוקת הצופן. באופן כללי תפוקת ARIA דומה לזו של AES וטובה מקמליה.


== תיאור כללי ==
הצופן בנוי מרשת החלפה תמורה המבצעת סדרה של פעולות הפיכות על בלוק קלט באורך 128 סיביות הנקרא "מצב" (state) באופן אחיד. הפעולות הן ברמה של בתים והמצב הפנימי מיוצג כמערך המכיל 16 בתים. הצופן מבצע את פעולות המצב באופן חוזר ונשנה 12, 14 או 16 פעמים בהתאם לאורך המפתח. עבור מפתח 128 סיביות מבוצעים בסך הכול 12 סבבים, עבור מפתח באורך 192 סיביות מבוצעים בסך הכול 14 סבבים ואילו עבור מפתח באורך 256 סיביות מבוצעים 16 סבבים. המצב הפנימי מאותחל בתחילה עם סיביות הקלט, בכל סבב הצופן מעדכן את המצב והפלט הסופי הוא המצב האחרון לאחר כל הסבבים. פעולות הצופן מחולקות לשלושה מרכיבים:

הוספת מפתח הסבב. בשלב זה קטע מהמפתח המורחב המתאים לסבב הנוכחי מחובר ב-XOR עם המצב הפנימי והתוצאה נשמרת כמצב החדש.
שכבת החלפה. בשכבת ההחלפה המצב הפנימי מוחלף בית אחר בית לפי טבלאות החלפה קבועות. ישנן ארבע תיבות החלפה שבהן משתמשים לסירוגין לפי סדר המתואר בהמשך.
שכבת פיזור. בשכבת הפיזור המצב הפנימי מוכפל במטריצה בינארית הפיכה קבועה מסדר 16x16 סיביות.
כמו כן פעולת הרחבת המפתח מקבלת את המפתח הסודי המסופק על ידי המשתמש ומרחיבה אותו בסך הכול ל-13, 15 או 17 מקטעים באורך 16 בתים כל אחד, בהתאם לאורך המפתח. כלומר 13 מקטעים עבור מפתח באורך 128 סיביות, 15 מקטעים עבור מפתח באורך 192 סיביות ו-17 מקטעים עבור מפתח באורך 256. הסיבה היא משום שבסבב האחרון במקום שכבת הפיזור מבוצעת שכבת הוספת המפתח פעם נוספת, ראו תרשים.


== פירוט פעולות הצופן ==
הפעולות הבאות מבוצעות על כל בתי המצב באופן אחיד.


=== שכבת החלפה ===
בשכבת ההחלפה (substitution layer) משתמש ARIA בשתי תיבות החלפה 
  
    
      
        
          S
          
            1
          
        
      
    
    {\displaystyle S_{1}}
  
 ו-
  
    
      
        
          S
          
            2
          
        
      
    
    {\displaystyle S_{2}}
  
 וכן התיבות ההופכיות שלהן 
  
    
      
        
          S
          
            1
          
          
            −
            1
          
        
      
    
    {\displaystyle S_{1}^{-1}}
  
 ו-
  
    
      
        
          S
          
            2
          
          
            −
            1
          
        
      
    
    {\displaystyle S_{2}^{-1}}
  
. תיבות ההחלפה נתונות בארבע הטבלאות להלן. הטבלאות בנויות מ-16 שורות ו-16 עמודות, בסך הכול 256 כניסות, כל כניסה מכילה מספר באורך 8 סיביות בטווח בין 0 ל-256 (או שתי ספרות הקסדצימליות בין 
  
    
      
        
          0x00
        
      
    
    {\displaystyle {\text{0x00}}}
  
 ל-
  
    
      
        
          0xff
        
      
    
    {\displaystyle {\text{0xff}}}
  
). הקלט לפונקציית ההחלפה הוא בית אחד המשמש כאינדקס לשורה והעמודה בטבלה, הניבל הראשון (ספרה הקסדצימלית ראשונה בטווח בין 0 ל-15) מציין עמודה ואילו הניבל השני מציין שורה. למשל אם הקלט הוא 
  
    
      
        
          0x00
        
      
    
    {\displaystyle {\text{0x00}}}
  
 הטבלה 
  
    
      
        
          S
          
            1
          
        
      
    
    {\displaystyle S_{1}}
  
 תחזיר 
  
    
      
        
          0x63
        
      
    
    {\displaystyle {\text{0x63}}}
  
 (בבסיס הקסדצימלי) ואילו הטבלה 
  
    
      
        
          S
          
            2
          
        
      
    
    {\displaystyle S_{2}}
  
 תחזיר 
  
    
      
        
          0xe2
        
      
    
    {\displaystyle {\text{0xe2}}}
  
 וכן 
  
    
      
        
          S
          
            1
          
          
            −
            1
          
        
        (
        
          0x95
        
        )
        =
        
          0xad
        
      
    
    {\displaystyle S_{1}^{-1}({\text{0x95}})={\text{0xad}}}
  
 או 
  
    
      
        
          S
          
            2
          
          
            −
            1
          
        
        (
        
          0x48
        
        )
        =
        
          0x67
        
      
    
    {\displaystyle S_{2}^{-1}({\text{0x48}})={\text{0x67}}}
  
:

הצופן עושה שימוש בתיבות ההחלפה בשני אופנים (כמתואר בתרשים לעיל). באופן הראשון הנקרא type 1 הבית הראשון מוחלף לפי התיבה הראשונה 
  
    
      
        
          S
          
            1
          
        
      
    
    {\displaystyle S_{1}}
  
 הבית השני לפי התיבה 
  
    
      
        
          S
          
            2
          
        
      
    
    {\displaystyle S_{2}}
  
, השלישי והרביעי לפי ההופכיות שלהן 
  
    
      
        
          S
          
            1
          
          
            −
            1
          
        
      
    
    {\displaystyle S_{1}^{-1}}
  
 ו-
  
    
      
        
          S
          
            2
          
          
            −
            1
          
        
      
    
    {\displaystyle S_{2}^{-1}}
  
 בהתאמה, החמישי והשישי שוב בתיבה הראשונה והשנייה וחוזר חלילה עד שמחליפים את כל בתי המצב. באופן השני הנקרא type 2 מבצעים את ההחלפה בסדר הפוך תחילה בתיבות ההופכיות 
  
    
      
        
          S
          
            1
          
          
            −
            1
          
        
      
    
    {\displaystyle S_{1}^{-1}}
  
 ו-
  
    
      
        
          S
          
            2
          
          
            −
            1
          
        
      
    
    {\displaystyle S_{2}^{-1}}
  
 ולאחר מכן 
  
    
      
        
          S
          
            1
          
        
      
    
    {\displaystyle S_{1}}
  
 ו-
  
    
      
        
          S
          
            2
          
        
      
    
    {\displaystyle S_{2}}
  
 לסירוגין, כמתואר בתרשים להלן. הפסאודו קוד הבא מתאר את פונקציות ההחלפה 
  
    
      
        S
        
          L
          
            1
          
        
      
    
    {\displaystyle SL_{1}}
  
 ו-
  
    
      
        S
        
          L
          
            2
          
        
      
    
    {\displaystyle SL_{2}}
  
 לפי type 1 ו-type 2 בהתאמה, הקלט הוא המצב הנוכחי 
  
    
      
        X
        =
        
          x
          
            0
          
        
        ,
        .
        .
        .
        ,
        
          x
          
            15
          
        
      
    
    {\displaystyle X=x_{0},...,x_{15}}
  
 והפלט הוא המצב החדש 
  
    
      
        Y
        =
        
          y
          
            0
          
        
        ,
        .
        .
        .
        ,
        
          y
          
            15
          
        
      
    
    {\displaystyle Y=y_{0},...,y_{15}}
  
:


=== שכבת פיזור ===
שכבת הפיזור היא פונקציה המסומנת באות A הממפה קלט באורך 16 בתים 
  
    
      
        (
        
          x
          
            0
          
        
        ,
        
          x
          
            1
          
        
        ,
        .
        .
        .
        ,
        
          x
          
            15
          
        
        )
      
    
    {\displaystyle (x_{0},x_{1},...,x_{15})}
  
 לפלט באורך דומה 
  
    
      
        (
        
          y
          
            0
          
        
        ,
        
          y
          
            1
          
        
        ,
        .
        .
        .
        ,
        
          y
          
            15
          
        
        )
      
    
    {\displaystyle (y_{0},y_{1},...,y_{15})}
  
 והיא מוגדרת כדלהלן:

שכבת הפיזור של ARIA תוכננה כך שהיא תהיה אינוולוציה כלומר עבור כל וקטור 
  
    
      
        x
      
    
    {\displaystyle x}
  
 מתקיים 
  
    
      
        A
        (
        A
        (
        x
        )
        )
        =
        x
      
    
    {\displaystyle A(A(x))=x}
  
. דרך אחרת להציג את המיפוי של 
  
    
      
        A
      
    
    {\displaystyle A}
  
 היא על ידי כפל מטריצות הבא:


=== פונקציות סבב ===
בכל סבב של צופן ARIA מופעלת אחת משתי הפונקציות 
  
    
      
        
          F
          
            e
          
        
      
    
    {\displaystyle F_{e}}
  
 ו-
  
    
      
        
          F
          
            o
          
        
      
    
    {\displaystyle F_{o}}
  
 שהן פונקציות סבב זוגית ואי זוגית בהתאמה המבצעות את שלוש הפעולות המתוארות לפי הסדר: הוספת מפתח, החלפה ופיזור, או בניסוח רשמי: 

  
    
      
        
          F
          
            o
          
        
        (
        
          P
          
            i
          
        
        ,
        e
        
          k
          
            i
          
        
        )
        =
        A
        (
        S
        
          L
          
            1
          
        
        (
        
          P
          
            i
          
        
        ⊕
        e
        
          k
          
            i
          
        
        )
        )
      
    
    {\displaystyle F_{o}(P_{i},ek_{i})=A(SL_{1}(P_{i}\oplus ek_{i}))}
  

  
    
      
        
          F
          
            e
          
        
        (
        
          P
          
            i
          
        
        ,
        e
        
          k
          
            i
          
        
        )
        =
        A
        (
        S
        
          L
          
            2
          
        
        (
        
          P
          
            i
          
        
        ⊕
        e
        
          k
          
            i
          
        
        )
        )
      
    
    {\displaystyle F_{e}(P_{i},ek_{i})=A(SL_{2}(P_{i}\oplus ek_{i}))}
  

כאשר 
  
    
      
        
          P
          
            i
          
        
      
    
    {\displaystyle P_{i}}
  
 הוא הבלוק הקלט של סבב 
  
    
      
        i
      
    
    {\displaystyle i}
  
 ו-
  
    
      
        A
      
    
    {\displaystyle A}
  
 היא פונקציית הפיזור, 
  
    
      
        S
        
          L
          
            i
          
        
      
    
    {\displaystyle SL_{i}}
  
 מתייחס לשכבת ההחלפה והערכים 
  
    
      
        e
        
          k
          
            i
          
        
      
    
    {\displaystyle ek_{i}}
  
 הם מפתחות הסבב אותם מכינים לפי תיאור תהליך הכנת המפתחות להלן. ההבדל בין שתי הפונקציות הוא סדר ההחלפה, ב-
  
    
      
        
          F
          
            o
          
        
      
    
    {\displaystyle F_{o}}
  
 ההחלפה מבוצעת לפי type 1 ואילו 
  
    
      
        
          F
          
            e
          
        
      
    
    {\displaystyle F_{e}}
  
 היא לפי type 2.


=== הכנת מפתח ===

תהליך ההכנה של מפתחות ההצפנה עבור כל הסבבים כולל שני שלבים: בשלב הראשון מכינים ארבעה ערכים באורך 128 סיביות כל אחד המסומנים 
  
    
      
        
          W
          
            0
          
        
        ,
        
          W
          
            1
          
        
        ,
        
          W
          
            2
          
        
        ,
        
          W
          
            3
          
        
      
    
    {\displaystyle W_{0},W_{1},W_{2},W_{3}}
  
 בהם מציבים את המפתח הסודי 
  
    
      
        M
        K
      
    
    {\displaystyle MK}
  
 (מפתח מאסטר) שהוא המפתח הסודי שסופק על ידי המשתמש, תוך שימוש ברשת פייסטל בשלושה סבבים לפי השיטה הבאה. תחילה מחלקים את המפתח הסודי לשני חצאים ימין ושמאל, כלומר מציבים את 128 הסיביות הראשונות של 
  
    
      
        M
        K
      
    
    {\displaystyle MK}
  
 במשתנה זמני 
  
    
      
        K
        L
      
    
    {\displaystyle KL}
  
 ומה שנותר מהמפתח מציבים במשתנה זמני נוסף 
  
    
      
        K
        R
      
    
    {\displaystyle KR}
  
. יתר סיביות המשתנה הזמני 
  
    
      
        K
        R
      
    
    {\displaystyle KR}
  
 מאופסות. כך שמתקבל:

  
    
      
        K
        L
         
        ‖
         
        K
        R
        =
        M
        K
         
        ‖
         
        0...0
      
    
    {\displaystyle KL\ \|\ KR=MK\ \|\ 0...0}
  

הסימן 
  
    
      
        ‖
      
    
    {\displaystyle \|}
  
 מייצג שרשור. בשלב השני מיישמים את רשת פייסטל בשלושה סבבים כך:

הפונקציות 
  
    
      
        
          F
          
            e
          
        
      
    
    {\displaystyle F_{e}}
  
 ו-
  
    
      
        
          F
          
            o
          
        
      
    
    {\displaystyle F_{o}}
  
 הן פונקציות הסבב המתוארות לעיל כאשר הקבועים 
  
    
      
        C
        
          K
          
            i
          
        
      
    
    {\displaystyle CK_{i}}
  
 משמשים כמפתחות הצפנה. כדי להכין את הקבועים 
  
    
      
        C
        
          K
          
            i
          
        
      
    
    {\displaystyle CK_{i}}
  
 תחילה מחשבים את 
  
    
      
        128
        ×
        3
      
    
    {\displaystyle 128\times 3}
  
 הסיביות הראשונות של חלק השבר של 
  
    
      
        
          π
          
            −
            1
          
        
      
    
    {\displaystyle \pi ^{-1}}
  
 כשהן מחולקות לשלושה המשתנים. הערכים הם:

  
    
      
        
          C
          
            1
          
        
        =
        
          0x517cc1b727220a94fe12abe8fa9a6ee0
        
      
    
    {\displaystyle C_{1}={\text{0x517cc1b727220a94fe12abe8fa9a6ee0}}}
  

  
    
      
        
          C
          
            2
          
        
        =
        
          0x6db14acc9e21c820ff28b1d5ef5de2b0
        
      
    
    {\displaystyle C_{2}={\text{0x6db14acc9e21c820ff28b1d5ef5de2b0}}}
  

  
    
      
        
          C
          
            3
          
        
        =
        
          0xdb92371d2126e9700324977504e8c90e
        
      
    
    {\displaystyle C_{3}={\text{0xdb92371d2126e9700324977504e8c90e}}}
  

ואז הקבועים 
  
    
      
        C
        
          K
          
            i
          
        
      
    
    {\displaystyle CK_{i}}
  
 מוגדרים בהתאם לאורך המפתח, לדוגמה עבור מפתח 128 סיביות משתמשים בקבועים לפי הסדר הזה ואילו עבור מפתחות אחרים משנים את סדר הקבועים לפי הטבלה הבאה:

את מפתחות כל הסבבים מכינים על ידי שילוב של ערכי 
  
    
      
        
          W
          
            i
          
        
      
    
    {\displaystyle W_{i}}
  
 ומהם מייצרים את 17 מפתחות ההצפנה והפענוח עבור כל הסבבים:

הביטוי 
  
    
      
        
          ⋘
          
            n
          
        
      
    
    {\displaystyle \lll ^{n}}
  
 פירושו הזזה מעגלית ברמה של סיביות 
  
    
      
        n
      
    
    {\displaystyle n}
  
 צעדים לשמאל בגבולות משתנה באורך 32 סיביות.
יש לשים לב שקיים מפתח סבב נוסף מעבר למספר הסבבים. מפתח זה נועד לשימוש בסבב האחרון שבו הטרנספורמציה A מוחלפת בשכבת הוספת מפתח נוספת. בסיכומו של דבר מספר המפתחות הדרוש הוא 13, 15 או 17 בהתאם לאורך המפתח. מפתחות הפענוח נגזרים ממפתחות ההצפנה כדלהלן:

  
    
      
        d
        
          k
          
            1
          
        
        =
        e
        
          k
          
            n
            −
            1
          
        
        ,
        d
        
          k
          
            2
          
        
        =
        A
        (
        e
        
          k
          
            n
          
        
        )
        ,
        d
        
          k
          
            3
          
        
        =
        A
        (
        e
        
          k
          
            n
            −
            1
          
        
        )
        ,
        .
        .
        .
        ,
        d
        
          k
          
            n
          
        
        =
        A
        (
        e
        
          k
          
            2
          
        
        )
        ,
        d
        
          k
          
            n
            +
            1
          
        
        =
        e
        
          k
          
            1
          
        
      
    
    {\displaystyle dk_{1}=ek_{n-1},dk_{2}=A(ek_{n}),dk_{3}=A(ek_{n-1}),...,dk_{n}=A(ek_{2}),dk_{n+1}=ek_{1}}
  
.


=== הצפנה ופענוח ===
להצפנת בלוק טקסט קריא 
  
    
      
        P
      
    
    {\displaystyle P}
  
 באורך 16 בתים עם מפתח באורך 128 סיביות, משתמשים ב-13 מפתחות הסבבים 
  
    
      
        e
        
          k
          
            1
          
        
        ,
        e
        
          k
          
            2
          
        
        ,
        .
        .
        .
        ,
        e
        
          k
          
            13
          
        
      
    
    {\displaystyle ek_{1},ek_{2},...,ek_{13}}
  
 מתהליך הכנת המפתחות לעיל ומבצעים:

  
    
      
        C
      
    
    {\displaystyle C}
  
 הוא הטקסט המוצפן. הפונקציות 
  
    
      
        
          F
          
            e
          
        
      
    
    {\displaystyle F_{e}}
  
 ו-
  
    
      
        
          F
          
            o
          
        
      
    
    {\displaystyle F_{o}}
  
 הן פונקציות הסבב המתוארות לעיל. בסבב האחרון הושמטה פונקציית הפיזור A ובמקומה מבוצע חיבור עם המפתח ה-13. במקרה של מפתחות אחרים המבנה נותר זהה ורק מספר הסבבים משתנה. פונקציית הפענוח של ARIA זהה לחלוטין לפונקציית ההצפנה למעט מפתחות הסבבים המוחלפים ב-
  
    
      
        d
        
          k
          
            1
          
        
        ,
        d
        
          k
          
            2
          
        
        ,
        .
        .
        .
        ,
        d
        
          k
          
            13
          
        
      
    
    {\displaystyle dk_{1},dk_{2},...,dk_{13}}
  
 אותם מכינים ממפתחות ההצפנה כמתואר לעיל.


=== וקטור בדיקה ===
להלן וקטור בדיקה של הצפנה עם מפתח באורך 256 סיביות:


== קוד לדוגמה ==


== ראו גם ==
צופן בלוקים
AES
SSL


== הערות שוליים ==